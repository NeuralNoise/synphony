// Generated by CoffeeScript 1.3.3
(function() {
  var Segmenter;

  Segmenter = (function() {

    function Segmenter(words, gpcs) {
      this.words = words;
      this.gpcs = gpcs;
    }

    Segmenter.prototype.segment = function() {
      var gpcs,
        _this = this;
      gpcs = this.gpcs.sortBy(function(gpc) {
        return gpc.graphemeName().length;
      });
      gpcs = gpcs.reverse();
      return this.words.each(function(word) {
        var foundGpc, gpc, remaining, wordGpcs, _i, _len;
        remaining = (word.get('name')).toLowerCase();
        wordGpcs = [];
        while (remaining !== '') {
          foundGpc = null;
          for (_i = 0, _len = gpcs.length; _i < _len; _i++) {
            gpc = gpcs[_i];
            if ((remaining.indexOf(gpc.graphemeName())) === 0) {
              foundGpc = gpc;
              break;
            }
          }
          if (!foundGpc) {
            wordGpcs = null;
            break;
          }
          remaining = remaining.substring(gpc.graphemeName().length);
          wordGpcs.push(foundGpc);
        }
        if (!(word.set({
          gpcs: wordGpcs
        }))) {
          throw new Error("Invalid word!");
        }
      });
    };

    return Segmenter;

  })();

}).call(this);
